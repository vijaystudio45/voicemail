<!DOCTYPE html>
{% load static %}
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Autoservice AI Dashboard</title>
    <link rel="shortcut icon" href="https://www.autoservice.ai/wp-content/uploads/2019/03/Untitled-1.png" type="image/x-icon">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/5.0.0/collection/components/icon/icon.min.css">
    <link rel="stylesheet" href="{% static "library/themes/adminlte/dist/css/AdminLTE.min.css" %}">
    <link rel="stylesheet" href="{% static "library/themes/adminlte/dist/css/skins/_all-skins.min.css" %}">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jvectormap/2.0.5/jquery-jvectormap.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-wysiwyg/0.3.3/bootstrap3-wysihtml5.min.css">

    <link href="{% static "atsdashboard/css/Lobibox.min.css" %}" rel="stylesheet" >
    <link href="{% static "atsdashboard/css/notifications.css" %}" rel="stylesheet">
    <link href="{% static "atsdashboard/css/style.css" %}" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.js" integrity="sha256-0YPKAwZP7Mp3ALMRVB2i8GXeEndvCq3eSl/WsAl1Ryk=" crossorigin="anonymous"></script>
    <script>
      $.widget.bridge('uibutton', $.ui.button);
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sparklines/2.1.2/jquery.sparkline.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-Knob/1.2.13/jquery.knob.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-daterangepicker/2.1.27/daterangepicker.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="{% static "library/themes/adminlte/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js" %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-slimScroll/1.3.8/jquery.slimscroll.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
    <script src="{% static "library/themes/adminlte/dist/js/adminlte.min.js" %}"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js"></script>
    <script src="{% static "atsdashboard/js/Lobibox.js" %}"></script>
    <script src="{% static "atsdashboard/js/common.js" %}"></script>

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Google Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">

    <style>
        .alert-str {
            font-size:25px;
            margin-left:20px;
        }

        #call_report {
            width: 30%;
        }
        #sms_response {
            width: 30%;
        }

        @media(max-width: 1200px) {
            #call_report {
                width: 50%;
            }
            #sms_response {
                width: 50%;
            }
        }

        @media(max-width: 800px) {
            #call_report {
                width: 60%;
            }
            #sms_response {
                width: 60%;
            }
        }

        @media(max-width: 500px) {
            #call_report {
                width: 80%;
            }
            #sms_response {
                width: 80%;
            }
        }


    </style>
</head>
<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
        <header class="main-header">
            <a class="navbar-brand logo_h" href="/"><img src="{% static "atsdashboard/asset/logo/logo.png" %}" alt="" style="width:150px; margin-top:-10px;"></a>
            <nav class="navbar navbar-static-top">
                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">
                    </ul>
                </div>
            </nav>
        </header>
        <aside class="main-sidebar">
            <section class="sidebar" style="padding-top:20px;">
                <ul class="sidebar-menu" data-widget="tree">
                </ul>
            </section>
            <!-- /.sidebar -->
        </aside>
        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <div id="loading" style="position:absolute; z-index:99999; display:none; margin-left:40%; top:100px;">
                <img src="{% static "atsdashboard/asset/gif/loading.gif" %}">
            </div>
            <section id="report_section" class="content-header">
			<div class="report_sec1">
                <span style="font-size:36px;">Send Text To Caller</span>
                {% if error != 1 %}
                    <div class="row" style="margin-top:30px;">
                        <div class="col-md-12">
                            {% if status == 1 %}
                                {% if ok_text == 0 %}
                                    <p style="font-size:20px;">Caller does not want text, please call him and submit report of the call.</p>
                                    <textarea id="call_report" class="form-control" rows="10"></textarea>
                                    <button class="btn btn-danger" style="margin-top:20px; width:30%;" onclick="onSubmitReport();">Submit</button>
                                {% elif ok_text == 1 %}
                                    <textarea id="sms_response" class="form-control" rows="10"></textarea>
                                    <button class="btn btn-default" style="margin-top:20px; width:30%;" onclick="onSend();">Send</button>
                                {% endif %}
                            {% elif status == 2 %}
                                <p class="alert-str">Voicemail is being processed by {{ replier_name }}</p>
                            {% elif status == 3 %}
                                <p class="alert-str">Voicemail was responded by {{ replier_name }}</p>
                            {% endif %}
                        </div>
                    </div>
                {% else %}
                    <div class="row" style="margin-top:30px;">
                        <div class="col-md-3">
                            <p class="alert-str">Sorry, something went wrong.</p>
                        </div>
                    </div>
                {% endif %}
				</div>
            </section>
        </div>
        <!-- /.content-wrapper -->
        <footer class="footer_sec" style="background-color:#ececec;">
            <div class="container">
                <div class="row" style="">
                    <div class="col-md-12" style="text-align:center;">
					<div class="copyright">
					<div class="col-sm-9">
                        <span>Â© 2020 Autoservice.ai. All Rights Reserved</span>
                       </div>
					   <div class="col-sm-3">
                        <a href="https://www.autoservice.ai/privacy-policy/" class="a-tag">Privacy Policy</a>
                        &nbsp;&nbsp;
                        <a href="https://www.autoservice.ai/terms-of-service/" class="a-tag">Terms of Service</a>
						</div>
						</div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Control Sidebar -->
        <div class="control-sidebar-bg"></div>
    </div>
    <!-- ./wrapper -->

    <script type="text/javascript">
        // *************** OnClick Send *************** //
        function onSend() {
            if ($("#sms_response").val() == "") {
                showMessage(alert_list["0x1001C"]["mode"],
                            alert_list["0x1001C"]["title"],
                            alert_list["0x1001C"]["msg"], 5000);
            }
            $.ajax({
                type: "POST",
                url: "/user/voicemail/send_response",
                beforeSend: function( xhr ) {
                    xhr.setRequestHeader("X-CSRFToken", getCsrfToken());
                },
                data: {
                    "vm_id": {{ vm_id }},
                    "replier_id": {{ replier_id }},
                    "sms_response": $("#sms_response").val()
                },
                success: function(res) {
                    showMessage(alert_list["0x1001B"]["mode"],
                                alert_list["0x1001B"]["title"],
                                alert_list["0x1001B"]["msg"], 5000);
                },
                error: function(res) {
                    if (res["responseText"] == "closed") {
                        showMessage(alert_list["0x1001A"]["mode"],
                                    alert_list["0x1001A"]["title"],
                                    alert_list["0x1001A"]["msg"], 5000);
                    } else {
                        showMessage(alert_list["0xF0001"]["mode"],
                                    alert_list["0xF0001"]["title"],
                                    alert_list["0xF0001"]["msg"], 5000);
                    }

                }
            });
        }

        // *************** OnClick Submit Report *************** //
        function onSubmitReport() {
            if ($("#call_report").val().split(" ") < 10) {
                showMessage(alert_list["0x1001D"]["mode"],
                            alert_list["0x1001D"]["title"],
                            alert_list["0x1001D"]["msg"], 5000);
                return;
            }
            $.ajax({
                type: "POST",
                url: "/user/voicemail/submit_report",
                beforeSend: function( xhr ) {
                    xhr.setRequestHeader("X-CSRFToken", getCsrfToken());
                },
                data: {
                    "vm_id": {{ vm_id }},
                    "replier_id": {{ replier_id }},
                    "report": $("#call_report").val()
                },
                success: function(res) {
                    showMessage(alert_list["0x1001B"]["mode"],
                                alert_list["0x1001B"]["title"],
                                alert_list["0x1001B"]["msg"], 5000);
                },
                error: function(res) {
                    if (res["responseText"] == "closed") {
                        showMessage(alert_list["0x1001A"]["mode"],
                                    alert_list["0x1001A"]["title"],
                                    alert_list["0x1001A"]["msg"], 5000);
                    } else {
                        showMessage(alert_list["0xF0001"]["mode"],
                                    alert_list["0xF0001"]["title"],
                                    alert_list["0xF0001"]["msg"], 5000);
                    }

                }
            });
        }
    </script>
</body>
</html>
